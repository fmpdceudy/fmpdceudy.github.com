---
layout:     post
title:      sed
categories: linux shell
---

sed是stream editor的缩写，一种流编辑器，它一次处理一行内容。处理时，把当前处理的行存储在临时缓冲区中，称为“模式空间”（pattern space），接着用sed命令处理缓冲区中的内容，处理完成后，把缓冲区的内容送往屏幕。接着处理下一行，这样不断重复，直到文件末尾。文件内容并没有改变，除非你使用重定向存储输出。sed主要用来自动编辑一个或多个文件，简化对文件的反复操作，编写转换程序等。

正常工作流程

![stream](http://pic002.cnblogs.com/images/2011/96760/2011111421151143.png)

## option

-n∶使用安静(silent)模式。在一般 sed 的用法中，所有来自 STDIN的资料一般都会被列出到萤幕上。但如果加上 -n 参数后，则只有经过sed 特殊处理的那一行(或者动作)才会被列出来。  
-e∶直接在指令列模式上进行 sed 的动作编辑；  
-f∶直接将 sed 的动作写在一个档案内， -f filename 则可以执行 filename 内的sed 动作；  
-r∶sed 的动作支援的是延伸型正规表示法的语法。(预设是基础正规表示法语法)  
-i∶直接修改读取的档案内容，而不是由萤幕输出。


##动作说明： [n1[,n2]]function
n1, n2 ：不见得会存在，一般代表『选择进行动作的行数』，举例来说，如果我的动作是需要在 10 到 20 行之间进行的，则『 10,20[动作行为] 』

## 行选择

| 动作  | 含义                | 解释                 |
|-------|---------------------|----------------------|
| 1     | 第一行              |                      |
| 1，2  | 第一行至第二行      |                      |
| /tmp/ | 含有tmp的行         | 可以是n1，也可以是n2 |
| n1,+2 | n1选中行及后之后2行 |                      |
| n1,$  | n1到最后一行        | 只支持'',不支持""    |
|-------|---------------------|----------------------|


## 动作

| 动作 | 含义     | 解释                            |
|------|----------|---------------------------------|
| d    | 删除     | 整行删除                        |
| p    | 显示     | 显示整行，一般与-n配合使用      |
| a    | 追加     | 在选中行之后添加新行,可以是多行 |
| i    | 插入     | 在选中行之前添加新行,可以是多行 |
| c    | 取代     | 取代整个选中行                  |
| s    | 取代     | s/要替换的字符串/新的字符串/g   |
| =    | 打印行号 |                                 |
|------|----------|---------------------------------|

## 組合命令

用{}包含，用;分割  
每个命令可以使用//只操作部分行

| 动作 | 含义                          | 解释 |
|------|-------------------------------|------|
| d    | 删除                          |      |
| p    | 显示                          |      |
| q    | 退出                          |      |
| s    | 取代                          |      |
| =    | 打印行号                      |      |
| n    | 读取下一行并覆盖pattern space |      |
| N    | 读取下一行并追加pattern space |      |
|------|-------------------------------|------|

## 緩存命令

| 动作 | 含义                                                          |
|------|---------------------------------------------------------------|
| h    | 拷贝pattern space的内容到holding buffer(特殊缓冲区)。         |
| H    | 追加pattern space的内容到holding buffer。                     |
| g    | 获得holding buffer中的内容，并替代当前pattern space中的文本。 |
| G    | 获得holding buffer中的内容，并追加到当前pattern space的后面。 |
| P    | 打印pattern space中的第一行。  //大写                         |
| x    | 互换pattern space和holding buffer中的文本。                   |
|------|---------------------------------------------------------------|

## s 替换标记

| 动作 | 含义                                                 |
|------|------------------------------------------------------|
| g    | 行内全面替换，如果没有g，只替换第一个匹配。          |
| y    | 把一个字符翻译为另一个字符(但是不能用于正则表达式)。 |
|------|------------------------------------------------------|

